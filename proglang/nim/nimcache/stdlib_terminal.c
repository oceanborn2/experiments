/* Generated by Nim Compiler v0.13.0 */
/*   (c) 2015 Andreas Rumpf */
/* The generated code is subject to the original license. */
/* Compiled for: Linux, amd64, gcc */
/* Command for C compiler:
   gcc -c  -w  -I/usr/lib/nim -o /run/media/pascal/Acer/experiments/proglang/nim/nimcache/stdlib_terminal.o /run/media/pascal/Acer/experiments/proglang/nim/nimcache/stdlib_terminal.c */
#define NIM_INTBITS 64

#include "nimbase.h"
#include <termios.h>
#include <string.h>
#include <stdio.h>
#include <unistd.h>
typedef struct NimStringDesc NimStringDesc;
typedef struct TGenericSeq TGenericSeq;
typedef unsigned char TY139218[32];
struct  TGenericSeq  {
NI len;
NI reserved;
};
struct  NimStringDesc  {
  TGenericSeq Sup;
NIM_CHAR data[SEQ_DECL_SIZE];
};
N_NIMCALL(void, setraw_140001)(int fd, int time);
static N_INLINE(void, nimFrame)(TFrame* s);
N_NOINLINE(void, stackoverflow_22201)(void);
static N_INLINE(void, popFrame)(void);
N_NIMCALL(void, setcursorpos_140201)(FILE* f, NI x, NI y);
N_NIMCALL(void, write_15489)(FILE* f, NimStringDesc* s);
static N_INLINE(void, appendString)(NimStringDesc* dest, NimStringDesc* src);
N_NIMCALL(NimStringDesc*, nimIntToStr)(NI x);
static N_INLINE(void, appendChar)(NimStringDesc* dest, NIM_CHAR c);
N_NIMCALL(NimStringDesc*, rawNewString)(NI space);
N_NIMCALL(void, setcursorxpos_140403)(FILE* f, NI x);
N_NIMCALL(void, cursorup_140801)(FILE* f, NI count);
N_NIMCALL(void, cursordown_141003)(FILE* f, NI count);
N_NIMCALL(void, cursorforward_141203)(FILE* f, NI count);
N_NIMCALL(void, cursorbackward_141403)(FILE* f, NI count);
N_NIMCALL(void, eraseline_141801)(FILE* f);
N_NIMCALL(void, erasescreen_142003)(FILE* f);
N_NIMCALL(void, resetattributes_142203)(FILE* f);
N_NIMCALL(void, setstyle_142601)(FILE* f, NU8 style);
static N_INLINE(NI, chckRange)(NI i, NI a, NI b);
N_NOINLINE(void, raiseRangeError)(NI64 val);
static N_INLINE(NI, addInt)(NI a, NI b);
N_NOINLINE(void, raiseOverflow)(void);
N_NIMCALL(void, writestyled_142852)(NimStringDesc* txt, NU8 style);
N_NIMCALL(void, setforegroundcolor_143045)(FILE* f, NU8 fg, NIM_BOOL bright);
N_NIMCALL(void, setbackgroundcolor_143220)(FILE* f, NU8 bg, NIM_BOOL bright);
N_NIMCALL(NIM_BOOL, isatty_143420)(FILE* f);
N_NIMCALL(NIM_CHAR, getch_143744)(void);
N_NOCONV(void, resetattributes_144038)(void);
STRING_LITERAL(TMP611, "\033[", 2);
STRING_LITERAL(TMP612, "\033[2K", 4);
STRING_LITERAL(TMP613, "\033[2J", 4);
STRING_LITERAL(TMP614, "\033[0m", 4);
extern TFrame* frameptr_19436;
NI gfg_142413;
NI gbg_142414;

static N_INLINE(void, nimFrame)(TFrame* s) {
	NI LOC1;
	LOC1 = 0;
	{
		if (!(frameptr_19436 == NIM_NIL)) goto LA4;
		LOC1 = ((NI) 0);
	}
	goto LA2;
	LA4: ;
	{
		LOC1 = ((NI) ((NI16)((*frameptr_19436).calldepth + ((NI16) 1))));
	}
	LA2: ;
	(*s).calldepth = ((NI16) (LOC1));
	(*s).prev = frameptr_19436;
	frameptr_19436 = s;
	{
		if (!((*s).calldepth == ((NI16) 2000))) goto LA9;
		stackoverflow_22201();
	}
	LA9: ;
}

static N_INLINE(void, popFrame)(void) {
	frameptr_19436 = (*frameptr_19436).prev;
}

N_NIMCALL(void, setraw_140001)(int fd, int time) {
	struct termios mode;
	int LOC1;
	int LOC2;
	nimfr("setRaw", "terminal.nim")
	memset((void*)(&mode), 0, sizeof(mode));
	nimln(130, "terminal.nim");
	LOC1 = 0;
	LOC1 = tcgetattr(fd, (&mode));
	nimln(131, "terminal.nim");
	mode.c_iflag = (unsigned int)(mode.c_iflag & ((unsigned int) -2047));
	nimln(133, "terminal.nim");
	mode.c_oflag = (unsigned int)(mode.c_oflag & ((unsigned int) -2));
	nimln(134, "terminal.nim");
	mode.c_cflag = (unsigned int)((unsigned int)(mode.c_cflag & ((unsigned int) -445)) | ((NI) 60));
	nimln(135, "terminal.nim");
	mode.c_lflag = (unsigned int)(mode.c_lflag & ((unsigned int) -32780));
	nimln(136, "terminal.nim");
	mode.c_cc[(((NI) 6))- 0] = 1;
	nimln(137, "terminal.nim");
	mode.c_cc[(((NI) 5))- 0] = 0;
	nimln(138, "terminal.nim");
	LOC2 = 0;
	LOC2 = tcsetattr(fd, time, (&mode));
	popFrame();
}

static N_INLINE(void, appendString)(NimStringDesc* dest, NimStringDesc* src) {
	memcpy(((NCSTRING) ((&(*dest).data[((*dest).Sup.len)- 0]))), ((NCSTRING) ((*src).data)), (NI)((*src).Sup.len + ((NI) 1)));
	(*dest).Sup.len += (*src).Sup.len;
}

static N_INLINE(void, appendChar)(NimStringDesc* dest, NIM_CHAR c) {
	(*dest).data[((*dest).Sup.len)- 0] = c;
	(*dest).data[((NI)((*dest).Sup.len + ((NI) 1)))- 0] = 0;
	(*dest).Sup.len += ((NI) 1);
}

N_NIMCALL(void, setcursorpos_140201)(FILE* f, NI x, NI y) {
	NimStringDesc* LOC1;
	NimStringDesc* LOC2;
	NimStringDesc* LOC3;
	nimfr("setCursorPos", "terminal.nim")
	nimln(147, "terminal.nim");
	LOC1 = 0;
	LOC2 = 0;
	LOC2 = nimIntToStr(y);
	LOC3 = 0;
	LOC3 = nimIntToStr(x);
	LOC1 = rawNewString(LOC2->Sup.len + LOC3->Sup.len + 4);
appendString(LOC1, ((NimStringDesc*) &TMP611));
appendString(LOC1, LOC2);
appendChar(LOC1, 59);
appendString(LOC1, LOC3);
appendChar(LOC1, 102);
	write_15489(f, LOC1);
	popFrame();
}

N_NIMCALL(void, setcursorxpos_140403)(FILE* f, NI x) {
	NimStringDesc* LOC1;
	NimStringDesc* LOC2;
	nimfr("setCursorXPos", "terminal.nim")
	nimln(162, "terminal.nim");
	LOC1 = 0;
	LOC2 = 0;
	LOC2 = nimIntToStr(x);
	LOC1 = rawNewString(LOC2->Sup.len + 3);
appendString(LOC1, ((NimStringDesc*) &TMP611));
appendString(LOC1, LOC2);
appendChar(LOC1, 71);
	write_15489(f, LOC1);
	popFrame();
}

N_NIMCALL(void, cursorup_140801)(FILE* f, NI count) {
	NimStringDesc* LOC1;
	NimStringDesc* LOC2;
	nimfr("cursorUp", "terminal.nim")
	nimln(189, "terminal.nim");
	LOC1 = 0;
	LOC2 = 0;
	LOC2 = nimIntToStr(count);
	LOC1 = rawNewString(LOC2->Sup.len + 3);
appendString(LOC1, ((NimStringDesc*) &TMP611));
appendString(LOC1, LOC2);
appendChar(LOC1, 65);
	write_15489(f, LOC1);
	popFrame();
}

N_NIMCALL(void, cursordown_141003)(FILE* f, NI count) {
	NimStringDesc* LOC1;
	NimStringDesc* LOC2;
	nimfr("cursorDown", "terminal.nim")
	nimln(199, "terminal.nim");
	LOC1 = 0;
	LOC2 = 0;
	LOC2 = nimIntToStr(count);
	LOC1 = rawNewString(LOC2->Sup.len + 3);
appendString(LOC1, ((NimStringDesc*) &TMP611));
appendString(LOC1, LOC2);
appendChar(LOC1, 66);
	write_15489(f, LOC1);
	popFrame();
}

N_NIMCALL(void, cursorforward_141203)(FILE* f, NI count) {
	NimStringDesc* LOC1;
	NimStringDesc* LOC2;
	nimfr("cursorForward", "terminal.nim")
	nimln(209, "terminal.nim");
	LOC1 = 0;
	LOC2 = 0;
	LOC2 = nimIntToStr(count);
	LOC1 = rawNewString(LOC2->Sup.len + 3);
appendString(LOC1, ((NimStringDesc*) &TMP611));
appendString(LOC1, LOC2);
appendChar(LOC1, 67);
	write_15489(f, LOC1);
	popFrame();
}

N_NIMCALL(void, cursorbackward_141403)(FILE* f, NI count) {
	NimStringDesc* LOC1;
	NimStringDesc* LOC2;
	nimfr("cursorBackward", "terminal.nim")
	nimln(219, "terminal.nim");
	LOC1 = 0;
	LOC2 = 0;
	LOC2 = nimIntToStr(count);
	LOC1 = rawNewString(LOC2->Sup.len + 3);
appendString(LOC1, ((NimStringDesc*) &TMP611));
appendString(LOC1, LOC2);
appendChar(LOC1, 68);
	write_15489(f, LOC1);
	popFrame();
}

N_NIMCALL(void, eraseline_141801)(FILE* f) {
	nimfr("eraseLine", "terminal.nim")
	nimln(273, "terminal.nim");
	write_15489(f, ((NimStringDesc*) &TMP612));
	nimln(274, "terminal.nim");
	setcursorxpos_140403(f, ((NI) 0));
	popFrame();
}

N_NIMCALL(void, erasescreen_142003)(FILE* f) {
	nimfr("eraseScreen", "terminal.nim")
	nimln(296, "terminal.nim");
	write_15489(f, ((NimStringDesc*) &TMP613));
	popFrame();
}

N_NIMCALL(void, resetattributes_142203)(FILE* f) {
	nimfr("resetAttributes", "terminal.nim")
	nimln(306, "terminal.nim");
	write_15489(f, ((NimStringDesc*) &TMP614));
	popFrame();
}

static N_INLINE(NI, chckRange)(NI i, NI a, NI b) {
	NI result;
{	result = 0;
	{
		NIM_BOOL LOC3;
		LOC3 = 0;
		LOC3 = (a <= i);
		if (!(LOC3)) goto LA4;
		LOC3 = (i <= b);
		LA4: ;
		if (!LOC3) goto LA5;
		result = i;
		goto BeforeRet;
	}
	goto LA1;
	LA5: ;
	{
		raiseRangeError(((NI64) (i)));
	}
	LA1: ;
	}BeforeRet: ;
	return result;
}

static N_INLINE(NI, addInt)(NI a, NI b) {
	NI result;
{	result = 0;
	result = (NI)((NU64)(a) + (NU64)(b));
	{
		NIM_BOOL LOC3;
		LOC3 = 0;
		LOC3 = (((NI) 0) <= (NI)(result ^ a));
		if (LOC3) goto LA4;
		LOC3 = (((NI) 0) <= (NI)(result ^ b));
		LA4: ;
		if (!LOC3) goto LA5;
		goto BeforeRet;
	}
	LA5: ;
	raiseOverflow();
	}BeforeRet: ;
	return result;
}

N_NIMCALL(void, setstyle_142601)(FILE* f, NU8 style) {
	nimfr("setStyle", "terminal.nim")
	{
		NU8 s_142837;
		NI i_142851;
		s_142837 = 0;
		nimln(1999, "system.nim");
		i_142851 = ((NI) 1);
		{
			nimln(2000, "system.nim");
			while (1) {
				NI TMP615;
				if (!(i_142851 <= ((NI) 8))) goto LA3;
				nimln(2001, "system.nim");
				{
					NimStringDesc* LOC8;
					NimStringDesc* LOC9;
					nimln(1098, "system.nim");
					if (!((style &(1U<<((NU)((((NU8)chckRange(i_142851, ((NU8) 1), ((NU8) 8)))- 1))&7U)))!=0)) goto LA6;
					nimln(2001, "system.nim");
					s_142837 = ((NU8)chckRange(i_142851, ((NU8) 1), ((NU8) 8)));
					nimln(338, "terminal.nim");
					LOC8 = 0;
					LOC9 = 0;
					LOC9 = nimIntToStr(((NI) (s_142837)));
					LOC8 = rawNewString(LOC9->Sup.len + 3);
appendString(LOC8, ((NimStringDesc*) &TMP611));
appendString(LOC8, LOC9);
appendChar(LOC8, 109);
					write_15489(f, LOC8);
				}
				LA6: ;
				nimln(2002, "system.nim");
				TMP615 = addInt(i_142851, ((NI) 1));
				i_142851 = (NI)(TMP615);
			} LA3: ;
		}
	}
	popFrame();
}

N_NIMCALL(void, writestyled_142852)(NimStringDesc* txt, NU8 style) {
	nimfr("writeStyled", "terminal.nim")
	nimln(348, "terminal.nim");
	setstyle_142601(stdout, style);
	nimln(349, "terminal.nim");
	write_15489(stdout, txt);
	nimln(350, "terminal.nim");
	resetattributes_142203(stdout);
	nimln(351, "terminal.nim");
	{
		NimStringDesc* LOC5;
		NimStringDesc* LOC6;
		nimln(349, "system.nim");
		if (!!((gfg_142413 == ((NI) 0)))) goto LA3;
		nimln(352, "terminal.nim");
		LOC5 = 0;
		LOC6 = 0;
		LOC6 = nimIntToStr(((NI) (gfg_142413)));
		LOC5 = rawNewString(LOC6->Sup.len + 3);
appendString(LOC5, ((NimStringDesc*) &TMP611));
appendString(LOC5, LOC6);
appendChar(LOC5, 109);
		write_15489(stdout, LOC5);
	}
	LA3: ;
	nimln(353, "terminal.nim");
	{
		NimStringDesc* LOC11;
		NimStringDesc* LOC12;
		nimln(349, "system.nim");
		if (!!((gbg_142414 == ((NI) 0)))) goto LA9;
		nimln(354, "terminal.nim");
		LOC11 = 0;
		LOC12 = 0;
		LOC12 = nimIntToStr(((NI) (gbg_142414)));
		LOC11 = rawNewString(LOC12->Sup.len + 3);
appendString(LOC11, ((NimStringDesc*) &TMP611));
appendString(LOC11, LOC12);
appendChar(LOC11, 109);
		write_15489(stdout, LOC11);
	}
	LA9: ;
	popFrame();
}

N_NIMCALL(void, setforegroundcolor_143045)(FILE* f, NU8 fg, NIM_BOOL bright) {
	NimStringDesc* LOC5;
	NimStringDesc* LOC6;
	nimfr("setForegroundColor", "terminal.nim")
	nimln(398, "terminal.nim");
	gfg_142413 = ((NI) (fg));
	nimln(399, "terminal.nim");
	{
		NI TMP616;
		if (!bright) goto LA3;
		TMP616 = addInt(gfg_142413, ((NI) 60));
		gfg_142413 = (NI)(TMP616);
	}
	LA3: ;
	nimln(400, "terminal.nim");
	LOC5 = 0;
	LOC6 = 0;
	LOC6 = nimIntToStr(gfg_142413);
	LOC5 = rawNewString(LOC6->Sup.len + 3);
appendString(LOC5, ((NimStringDesc*) &TMP611));
appendString(LOC5, LOC6);
appendChar(LOC5, 109);
	write_15489(f, LOC5);
	popFrame();
}

N_NIMCALL(void, setbackgroundcolor_143220)(FILE* f, NU8 bg, NIM_BOOL bright) {
	NimStringDesc* LOC5;
	NimStringDesc* LOC6;
	nimfr("setBackgroundColor", "terminal.nim")
	nimln(420, "terminal.nim");
	gbg_142414 = ((NI) (bg));
	nimln(421, "terminal.nim");
	{
		NI TMP617;
		if (!bright) goto LA3;
		TMP617 = addInt(gbg_142414, ((NI) 60));
		gbg_142414 = (NI)(TMP617);
	}
	LA3: ;
	nimln(422, "terminal.nim");
	LOC5 = 0;
	LOC6 = 0;
	LOC6 = nimIntToStr(gbg_142414);
	LOC5 = rawNewString(LOC6->Sup.len + 3);
appendString(LOC5, ((NimStringDesc*) &TMP611));
appendString(LOC5, LOC6);
appendChar(LOC5, 109);
	write_15489(f, LOC5);
	popFrame();
}

N_NIMCALL(NIM_BOOL, isatty_143420)(FILE* f) {
	NIM_BOOL result;
	int LOC1;
	int LOC2;
	nimfr("isatty", "terminal.nim")
	result = 0;
	nimln(433, "terminal.nim");
	nimln(349, "system.nim");
	nimln(433, "terminal.nim");
	LOC1 = 0;
	LOC1 = fileno(f);
	LOC2 = 0;
	LOC2 = isatty(LOC1);
	result = !((LOC2 == ((NI32) 0)));
	popFrame();
	return result;
}

N_NIMCALL(NIM_CHAR, getch_143744)(void) {
	NIM_CHAR result;
	int fd;
	struct termios oldmode;
	int LOC1;
	int LOC2;
	nimfr("getch", "terminal.nim")
	result = 0;
	nimln(507, "terminal.nim");
	fd = fileno(stdin);
	memset((void*)(&oldmode), 0, sizeof(oldmode));
	nimln(509, "terminal.nim");
	LOC1 = 0;
	LOC1 = tcgetattr(fd, (&oldmode));
	nimln(510, "terminal.nim");
	setraw_140001(fd, ((int) 2));
	nimln(511, "terminal.nim");
	result = fgetc(stdin);
	nimln(512, "terminal.nim");
	LOC2 = 0;
	LOC2 = tcsetattr(fd, ((int) 1), (&oldmode));
	popFrame();
	return result;
}

N_NOCONV(void, resetattributes_144038)(void) {
	nimfr("resetAttributes", "terminal.nim")
	nimln(535, "terminal.nim");
	resetattributes_142203(stdout);
	popFrame();
}
NIM_EXTERNC N_NOINLINE(void, stdlib_terminalInit000)(void) {
	nimfr("terminal", "terminal.nim")
	nimln(323, "terminal.nim");
	gfg_142413 = ((NI) 0);
	nimln(324, "terminal.nim");
	gbg_142414 = ((NI) 0);
	popFrame();
}

NIM_EXTERNC N_NOINLINE(void, stdlib_terminalDatInit000)(void) {
}

